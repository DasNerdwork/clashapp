var executeOnlyOnce=!0;function ready(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}const ws=new WebSocket("wss://websocket.dasnerdwork.net/");function addToFile(e){let t={champname:e.getElementsByTagName("span")[0].innerText,champid:e.getElementsByTagName("img")[0].dataset.id,teamid:window.location.pathname.split("/team/")[1],request:"add"};ws.send(JSON.stringify(t))}function removeFromFile(e){let t={champname:e.getElementsByTagName("span")[0].innerText,champid:e.getElementsByTagName("img")[0].dataset.id,teamid:window.location.pathname.split("/team/")[1],request:"remove"};ws.send(JSON.stringify(t))}function modifyTeamRating(e,t){const a=new Date;a.setDate(a.getDate()+365);let n="expires="+a.toUTCString(),s=window.location.pathname.split("/team/")[1];document.cookie=s+"="+e+";"+n+";";let l={hash:t,rating:e,teamid:s,request:"rate"};ws.send(JSON.stringify(l))}function showIdentityNotice(e){e?document.getElementById("identityNotice").classList.replace("hidden","block"):document.getElementById("identityNotice").classList.replace("block","hidden")}function addHistoryMessage(e){const t=document.getElementById("historyContainer"),a=document.createElement("span");a.classList.add("text-[#333344]"),__(e).then((function(e){a.innerText=e,t.insertBefore(a,t.firstChild.nextSibling)}))}function addCustomHistoryMessage(e,t,a,n,s){n=n||"",s=s||"";const l=document.getElementById("historyContainer"),i=document.createElement("span");__(e).then((function(e){i.innerHTML="<span class='text-"+a+"/100'>"+t+"</span> "+e.replace("%1",n).replace("%2",s),l.insertBefore(i,l.firstChild.nextSibling)}))}function makeDragDroppable(){let e=document.getElementsByClassName("hoverer");for(i=0;i<e.length;i++)e[i].classList.contains("locked")||(e[i].addEventListener("dragstart",t),e[i].addEventListener("drop",a),e[i].addEventListener("dragenter",s),e[i].addEventListener("dragover",n));function t(e){if(!e.srcElement.parentElement.classList.contains("locked"))return e.dataTransfer.setData("fromID",e.srcElement.previousSibling.dataset.id),e.dataTransfer.setData("fromName",e.srcElement.parentElement.parentElement.getElementsByTagName("span")[0].innerText),e.dataTransfer.setData("isDraggable",e.srcElement.parentElement.classList),e.dataTransfer.setDragImage(e.srcElement.previousSibling,24,24),oldIndex=getChildIndex(e.srcElement.parentElement.parentElement);e.preventDefault()}function a(e){if(e.srcElement.parentElement.classList.contains("locked"))e.preventDefault();else{var t=e.dataTransfer.getData("fromID"),a=e.dataTransfer.getData("fromName"),n=e.srcElement.previousSibling.dataset.id,l=e.srcElement.parentElement.parentElement.getElementsByTagName("span")[0].innerText;if(s(e),"hoverer group"!=e.dataTransfer.getData("isDraggable"))s(e);else{let e={fromName:a,fromID:t,toName:l,toID:n,teamid:window.location.pathname.split("/team/")[1],request:"swap"};ws.send(JSON.stringify(e))}}}function n(e){s(e),e.target.parentElement.classList.contains("locked")?e.dataTransfer.dropEffect="none":e.dataTransfer.dropEffect="move"}function s(e){return e.preventDefault(),e.stopPropagation(),!1}}function addContextMenuToSelectedBans(){let e=document.getElementsByClassName("selected-ban-champion");Array.from(e).forEach((e=>{e.firstChild.oncontextmenu=customBanContextMenu,document.onclick=hideCustomBanContextMenu}))}function hideCustomBanContextMenu(){document.getElementById("customBanContextMenu")&&(document.getElementById("customBanContextMenu").classList.replace("opacity-100","opacity-0"),setTimeout((()=>{document.getElementById("customBanContextMenu").style.left="0px",document.getElementById("customBanContextMenu").style.top="0px"}),75)),document.getElementById("customBanUnlockMenu")&&(document.getElementById("customBanUnlockMenu").classList.replace("opacity-100","opacity-0"),setTimeout((()=>{document.getElementById("customBanUnlockMenu").style.left="0px",document.getElementById("customBanUnlockMenu").style.top="0px"}),75))}function customBanContextMenu(e){if(e.preventDefault(),2===e.button)if(document.getElementById("customBanContextMenu").classList.contains("opacity-100")||document.getElementById("customBanUnlockMenu").classList.contains("opacity-100"))if(e.target.parentElement.classList.contains("locked")){let t=document.getElementById("customBanUnlockMenu");t.style.left=e.pageX+"px",t.style.top=e.pageY+"px"}else{let t=document.getElementById("customBanContextMenu");t.style.left=e.pageX+"px",t.style.top=e.pageY+"px"}else{if(e.target.parentElement.classList.contains("locked")){let t=document.getElementById("customBanUnlockMenu");t.classList.replace("opacity-0","opacity-100"),t.style.left=e.pageX+"px",t.style.top=e.pageY+"px"}else{let t=document.getElementById("customBanContextMenu");t.classList.replace("opacity-0","opacity-100"),t.style.left=e.pageX+"px",t.style.top=e.pageY+"px"}currentSelectedContextMenuElement=e.target.parentElement.parentElement}}function lockSelectedBan(e,t=!0){e.firstChild.classList.add("locked"),e.firstChild.draggable=!1,e.firstChild.onclick=null;let a=e.firstChild.firstChild;if(a.style.filter="url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg'><filter id='grayscale'><feColorMatrix type='matrix' values='0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 0 1 0'/></filter></svg>#grayscale\")",a.style.filter="gray",a.style.WebkitFilter="grayscale(100%)",a.nextSibling.classList.add("hidden"),t){let t={index:Array.from(e.parentElement.children).indexOf(e),champname:e.firstChild.nextSibling.innerText,champid:e.getElementsByTagName("img")[0].dataset.id,teamid:window.location.pathname.split("/team/")[1],request:"lock"};ws.send(JSON.stringify(t))}}function unlockSelectedBan(e,t=!0){e.firstChild.classList.remove("locked"),e.firstChild.draggable=!0,e.firstChild.onclick=function(){};let a=e.firstChild.firstChild;if(a.style.filter="",a.style.WebkitFilter="",a.nextSibling.classList.remove("hidden"),t){let t={index:Array.from(e.parentElement.children).indexOf(e),champname:e.firstChild.nextSibling.innerText,champid:e.getElementsByTagName("img")[0].dataset.id,teamid:window.location.pathname.split("/team/")[1],request:"unlock"};ws.send(JSON.stringify(t))}}ws.onopen=e=>{if(null!=document.getElementById("highlighter"))var t=document.getElementById("highlighter").innerText;else t="";let a={teamid:window.location.pathname.split("/team/")[1],name:t,request:"firstConnect"};ws.send(JSON.stringify(a))},ws.onmessage=e=>{if("{"==Array.from(e.data)[0]){var t=JSON.parse(e.data),a=document.getElementById("selectedBans");if(t.hasOwnProperty("SuggestedBans")){var n=0;if(t.Status>n){n=t.Status;var s="";let e=0;fetch("https://clashscout.com/clashapp/data/patch/version.txt").then((e=>e.text())).then((n=>{for(const l of t.SuggestedBans)executeOnlyOnce?(s+='<div class="selected-ban-champion h-fit fullhd:w-16 twok:w-24 opacity-0" style="animation: .5s ease-in-out '+e+'s 1 fadeIn; animation-fill-mode: forwards;"><div class="hoverer group'+("locked"===l.status?" locked":"")+'" '+("locked"===l.status?'draggable="false" ':'draggable="true" ')+'onclick="'+("locked"===l.status?"":"removeFromFile(this.parentElement);")+'"><img class="selected-ban-icon twok:max-h-14 fullhd:max-h-11" data-id="'+l.id+'" src="/clashapp/data/patch/'+n+"/img/champion/"+l.id+'.webp" style="filter: '+("locked"===l.status?"grayscale(100%)":"none")+'"><img class="removal-overlay twok:max-h-14 fullhd:max-h-11 twok:-mt-14 opacity-0 group-hover:opacity-100'+("locked"===l.status?" hidden":"")+'" src="/clashapp/data/misc/RemovalOverlay.webp"></div><span class="selected-ban-caption block">'+l.name+"</span></div>",e+=.1):(a.innerHTML.includes("/champion/"+l.id+".webp")?s+='<div class="selected-ban-champion h-fit fullhd:w-16 twok:w-24">':s+='<div class="selected-ban-champion h-fit fullhd:w-16 twok:w-24" style="animation: .1s ease-in-out 0s 1 slideIn; animation-fill-mode: forwards;">',s+='<div class="hoverer group'+("locked"===l.status?" locked":"")+'" '+("locked"===l.status?"":' draggable="true"')+'" '+("locked"===l.status?"":'onclick="removeFromFile(this.parentElement);"')+'><img class="selected-ban-icon twok:max-h-14 fullhd:max-h-11" data-id="'+l.id+'" src="/clashapp/data/patch/'+n+"/img/champion/"+l.id+'.webp" style="filter: '+("locked"===l.status?"grayscale(100%)":"none")+'"><img class="removal-overlay twok:max-h-14 fullhd:max-h-11 fullhd:-mt-11 twok:-mt-14 opacity-0 group-hover:opacity-100'+("locked"===l.status?" hidden":"")+'" src="/clashapp/data/misc/RemovalOverlay.webp"></div><span class="selected-ban-caption block">'+l.name+"</span></div>");executeOnlyOnce=!1,a.innerHTML=s,banSearchContainer=document.getElementById("banSearch").parentElement,champSelectorContainer=document.getElementById("champSelect"),t.SuggestedBans.length>=6?(banSearchContainer.classList.replace("twok:h-[16.5rem]","twok:h-[10.5rem]"),banSearchContainer.classList.replace("fullhd:h-[17rem]","fullhd:h-[12rem]"),champSelectorContainer.classList.replace("twok:h-[13rem]","twok:h-[7.5rem]"),champSelectorContainer.classList.replace("fullhd:h-[13.5rem]","fullhd:h-[9rem]"),a.parentElement.classList.replace("pb-3","pb-1")):(banSearchContainer.classList.replace("twok:h-[10.5rem]","twok:h-[16.5rem]"),banSearchContainer.classList.replace("fullhd:h-[12rem]","fullhd:h-[17rem]"),champSelectorContainer.classList.replace("twok:h-[7.5rem]","twok:h-[13rem]"),champSelectorContainer.classList.replace("fullhd:h-[9rem]","fullhd:h-[13.5rem]"),a.parentElement.classList.replace("pb-1","pb-3")),makeDragDroppable();addContextMenuToSelectedBans()}))}}else if("ElementAlreadyInArray"==t.status){var l=new Date;alert("["+l.toLocaleTimeString()+"] Dieser Champion wurde bereits ausgewählt.\n")}else if("MaximumElementsExceeded"==t.status){l=new Date;alert("["+l.toLocaleTimeString()+"] Die maximale Anzahl an ausgewählten Champions wurde erreicht.\n")}else if("CodeInjectionDetected"==t.status){l=new Date;alert("["+l.toLocaleTimeString()+"] WARNUNG: Dieser Code Injection Versuch wurde geloggt und dem Administrator mitgeteilt.\n")}else if("InvalidTeamID"==t.status){l=new Date;alert("["+l.toLocaleTimeString()+"] Die Anfrage für diese Team ID ist nicht gültig.\n")}else if("FileDidNotExist"==t.status)window.location.reload();else if("Update"==t.status);else if("FirstConnect"==t.status)if(null!=document.getElementById("highlighter")){document.getElementById("highlighter").classList.add("underline","text-"+t.color+"/100")}else{const e=document.createElement("div"),a=document.createElement("img"),n=document.createElement("span"),s=document.createElement("p");switch(e.style.marginTop="-13px",t.name){case"Krug":case"Wolf":e.style.marginLeft="-5.75rem";break;case"Nashor":case"Herald":case"Minion":case"Raptor":case"Gromp":e.style.marginLeft="-6.75rem";break;case"Sentinel":case"Scuttler":e.style.marginLeft="-7rem";break;case"Brambleback":e.style.marginLeft="-10rem";break;default:e.style.marginLeft="-9rem"}e.setAttribute("onmouseover","showIdentityNotice(true)"),e.setAttribute("onmouseout","showIdentityNotice(false)"),n.setAttribute("onmouseover","showIdentityNotice(true)"),n.setAttribute("onmouseout","showIdentityNotice(false)"),e.classList.add("z-20","w-40","h-8"),a.src="/clashapp/data/misc/monsters/"+t.name.toLowerCase()+".webp",a.width="32",a.classList.add("align-middle","mr-2.5","no-underline","inline-flex"),s.id="highlighter",s.classList.add("inline","underline","decoration-2","text-"+t.color+"/100"),s.style.textDecorationSkipInk="none",n.classList.add("text-white"),n.innerText=t.name,s.appendChild(n),e.appendChild(a),e.appendChild(s),document.getElementById("highlighterAfter").insertBefore(e,null);const l=document.getElementById("identityNotice");l.setAttribute("onmouseover","showIdentityNotice(true)"),l.setAttribute("onmouseout","showIdentityNotice(false)")}else"Message"==t.status?"added %1."==t.message||"removed %1."==t.message?addCustomHistoryMessage(t.message,t.name,t.color,t.champ):"swapped %1 with %2."==t.message?addCustomHistoryMessage(t.message,t.name,t.color,t.champ1,t.champ2):addCustomHistoryMessage(t.message,t.name,t.color):"Lock"==t.status?(addCustomHistoryMessage(t.message,t.name,t.color,t.champ),lockSelectedBan(document.getElementById("selectedBans").children[t.index],!1)):"Unlock"==t.status&&(addCustomHistoryMessage(t.message,t.name,t.color,t.champ),unlockSelectedBan(document.getElementById("selectedBans").children[t.index],!1))}else addHistoryMessage(e.data)},ws.onclose=e=>{clearTimeout(this.pingTimeout)};
