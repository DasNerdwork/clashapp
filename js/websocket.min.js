function ready(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}const ws=new WebSocket("wss://dasnerdwork.net:8081/");function addToFile(e){let t={champname:e.getElementsByTagName("span")[0].innerText,champid:e.getElementsByTagName("img")[0].dataset.id,teamid:window.location.pathname.split("/team/")[1],request:"add"};ws.send(JSON.stringify(t))}function removeFromFile(e){let t={champname:e.getElementsByTagName("span")[0].innerText,champid:e.getElementsByTagName("img")[0].dataset.id,teamid:window.location.pathname.split("/team/")[1],request:"remove"};ws.send(JSON.stringify(t))}function modifyTeamRating(e,t){const a=new Date;a.setDate(a.getDate()+365);let n="expires="+a.toUTCString(),s=window.location.pathname.split("/team/")[1];document.cookie=s+"="+e+";"+n+";";let i={hash:t,rating:e,teamid:s,request:"rate"};ws.send(JSON.stringify(i))}function showIdentityNotice(e){e?document.getElementById("identityNotice").classList.replace("hidden","block"):document.getElementById("identityNotice").classList.replace("block","hidden")}function addHistoryMessage(e){const t=document.getElementById("historyContainer"),a=document.createElement("span");a.innerText=e,a.classList.add("text-[#333344]"),t.insertBefore(a,t.firstChild.nextSibling)}function addCustomHistoryMessage(e,t,a){const n=document.getElementById("historyContainer"),s=document.createElement("span");s.innerHTML="<span class='text-"+a+"/100'>"+t+"</span> "+e,n.insertBefore(s,n.firstChild.nextSibling)}function makeDragDroppable(){let e=document.getElementsByClassName("hoverer");for(i=0;i<e.length;i++)e[i].addEventListener("dragstart",t),e[i].addEventListener("drop",a),e[i].addEventListener("dragenter",s),e[i].addEventListener("dragover",n);function t(e){return e.dataTransfer.setData("fromName",e.srcElement.previousSibling.dataset.id),e.dataTransfer.setData("isDraggable",e.srcElement.parentElement.classList),e.dataTransfer.setDragImage(e.srcElement.previousSibling,24,24),oldIndex=getChildIndex(e.srcElement.parentElement.parentElement)}function a(e){var t=e.dataTransfer.getData("fromName"),a=e.srcElement.previousSibling.dataset.id;if(s(e),"hoverer group"!=e.dataTransfer.getData("isDraggable"))s(e);else{let e={fromName:t,toName:a,teamid:window.location.pathname.split("/team/")[1],request:"swap"};ws.send(JSON.stringify(e))}}function n(e){e.dataTransfer.dropEffect="move",s(e)}function s(e){return e.preventDefault(),e.stopPropagation(),!1}}fetch("https://clash.dasnerdwork.net/clashapp/data/patch/version.txt").then((e=>e.text())).then((e=>{var t=!0;ws.onopen=e=>{if(null!=document.getElementById("highlighter"))var t=document.getElementById("highlighter").innerText;else t="";let a={teamid:window.location.pathname.split("/team/")[1],name:t,request:"firstConnect"};ws.send(JSON.stringify(a))},ws.onmessage=a=>{if("{"==Array.from(a.data)[0]){var n=JSON.parse(a.data),s=document.getElementById("selectedBans");if(n.hasOwnProperty("SuggestedBans")){var i=0;if(n.Status>i){i=n.Status;var o="";let a=0;for(const i of n.SuggestedBans)t?(o+='<div class="selected-ban-champion fullhd:w-16 twok:w-24 opacity-0" style="animation: .5s ease-in-out '+a+'s 1 fadeIn; animation-fill-mode: forwards;"><div class="hoverer group" draggable="true" onclick="removeFromFile(this.parentElement);"><img class="selected-ban-icon twok:max-h-14 fullhd:max-h-11" data-id="'+i.id+'" src="/clashapp/data/patch/'+e+"/img/champion/"+i.id+'.webp"><img class="removal-overlay twok:max-h-14 fullhd:max-h-11 fullhd:-mt-11 twok:-mt-14 opacity-0 group-hover:opacity-100" src="/clashapp/data/misc/RemovalOverlay.webp"></div><span class="selected-ban-caption block">'+i.name+"</span></div>",a+=.1):(s.innerHTML.includes("/champion/"+i.id+".webp")?o+='<div class="selected-ban-champion fullhd:w-16 twok:w-24">':o+='<div class="selected-ban-champion fullhd:w-16 twok:w-24" style="animation: .1s ease-in-out 0s 1 slideIn; animation-fill-mode: forwards;">',o+='<div class="hoverer group" draggable="true" onclick="removeFromFile(this.parentElement);"><img class="selected-ban-icon twok:max-h-14 fullhd:max-h-11" data-id="'+i.id+'" src="/clashapp/data/patch/'+e+"/img/champion/"+i.id+'.webp"><img class="removal-overlay twok:max-h-14 fullhd:max-h-11 fullhd:-mt-11 twok:-mt-14 opacity-0 group-hover:opacity-100" src="/clashapp/data/misc/RemovalOverlay.webp"></div><span class="selected-ban-caption block">'+i.name+"</span></div>");t=!1,s.innerHTML=o,makeDragDroppable()}}else if("ElementAlreadyInArray"==n.status){var r=new Date;alert("["+r.toLocaleTimeString()+"] Dieser Champion wurde bereits ausgew채hlt.\n")}else if("MaximumElementsExceeded"==n.status){r=new Date;alert("["+r.toLocaleTimeString()+"] Die maximale Anzahl an ausgew채hlten Champions wurde erreicht.\n")}else if("CodeInjectionDetected"==n.status){r=new Date;alert("["+r.toLocaleTimeString()+"] WARNUNG: Dieser Code Injection Versuch wurde geloggt und dem Administrator mitgeteilt.\n")}else if("InvalidTeamID"==n.status){r=new Date;alert("["+r.toLocaleTimeString()+"] Die Anfrage f체r diese Team ID ist nicht g체ltig.\n")}else if("FileDidNotExist"==n.status)window.location.reload();else if("Success"==n.status);else if("Update"==n.status);else if("FirstConnect"==n.status)if(null!=document.getElementById("highlighter")){document.getElementById("highlighter").classList.add("underline","decoration-"+n.color)}else{const e=document.createElement("div"),t=document.createElement("img"),a=document.createElement("span");switch(e.style.marginTop="-13px",n.name){case"Krug":case"Wolf":e.style.marginLeft="-5.75rem";break;case"Nashor":case"Herald":case"Minion":case"Raptor":case"Gromp":e.style.marginLeft="-6.75rem";break;case"Sentinel":case"Scuttler":e.style.marginLeft="-7rem";break;default:e.style.marginLeft="-9rem"}e.setAttribute("onmouseover","showIdentityNotice(true)"),e.setAttribute("onmouseout","showIdentityNotice(false)"),a.setAttribute("onmouseover","showIdentityNotice(true)"),a.setAttribute("onmouseout","showIdentityNotice(false)"),e.classList.add("z-20","w-36","h-8"),t.src="/clashapp/data/misc/monsters/"+n.name.toLowerCase()+".webp",t.width="32",t.classList.add("align-middle","mr-2.5","no-underline","inline-flex"),a.id="highlighter",a.classList.add("underline","decoration-2","decoration-"+n.color+"/100"),a.style.textDecorationSkipInk="none",a.innerText=n.name,e.appendChild(t),e.appendChild(a),document.getElementById("highlighterAfter").insertBefore(e,null);const s=document.getElementById("identityNotice");s.setAttribute("onmouseover","showIdentityNotice(true)"),s.setAttribute("onmouseout","showIdentityNotice(false)")}else"Message"==n.status&&addCustomHistoryMessage(n.message,n.name,n.color)}else addHistoryMessage(a.data)},ws.onclose=e=>{clearTimeout(this.pingTimeout)}}));
